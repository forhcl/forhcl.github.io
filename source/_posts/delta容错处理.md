---
title: delta容错处理
hidden: true
date: 2020-01-12 10:18:35
tags:
categories:
---

`org.junit.Assert.assertEquals(double expected,double actual,double delta)`

&emsp;&emsp;在多数情况下，delta参数(非负)可以是零，我们大可放心地忽略它。它总是伴随着非精确计算（其中包括许多浮点计算）而出现。delta提供了一个误差范围。如果实际值在expected - delta和expected + delta范围之内，则测试算通过。当进行带有舍入误差或截断误差的数学运算时，或者当断言一个关于文件修改日期的条件时，你就会发现它非常有用，因为这些数据的精确度取决于操作系统。

&emsp;&emsp;浮点数计算并不精确——通常存在舍入错误和由于表示引起的错误（例如，0.1不能用用二进制浮点精确表示）。因此，直接比较两个浮点值是否相等通常不是一个好主意，因为它们可能会有少量不同，具体取决于它们的计算方式。

&emsp;&emsp;在JUnit断言方法中的`delta`描述了你可以容忍它们仍然被认为是相等的差异值，此值的大小完全取决于您要比较的值，比较double时，通常采用预期值除以10<sub>6</sub>。

十进制的0.65转化为二进制表示为0.1010011...（跟精度有关）

十进制小数转换为二进制通常是乘二取整法来计算的。比如0.65换算为二进制就是：`0.65*2=1.3`取1，留下0.3继续乘二取整：`0.3*2=0.6`取0，留下0.6继续乘二取整；`0.6*2=1.2`取1，留下0.2继续乘二取整......

一直循环，直到达到精度限制才停止（所以，计算机保存的小数一般会有误差，所以在编程中，要比较两个小数是否相等，只能比较某个精度范围内的相等）


